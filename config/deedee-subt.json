{
  "version": 2,
  "robot": {
    "modules": {
      "app": {
          "driver": "application",
          "in": ["emergency_stop", "pose3d", "scan360"],
          "out": ["desired_speed"],
          "init": {
            "init_path": "2.5,0",
            "max_speed": 0.1,
            "symmetric": false,
            "speed_policy": "conservative",
            "rotation_p": 0.5,
	    "max_obstacle_distance": 0.4,
            "dangerous_dist": 0.15,
            "min_safe_dist": 1.0,
            "virtual_bumper_sec": 120.0,
            "virtual_bumper_radius": 1.0,
	    "follow_wall": {
              "max_wall_distance": 0.8
	    }
          }
      },
      "timer": {
        "driver": "timer",
        "in": [],
        "out": ["tick"],
        "init": {
          "sleep": 0.05
        }
      },
      "deedee": {
        "driver": "osgar.drivers.deedee:Deedee",
        "in": ["desired_speed", "info", "tick"],
        "out": ["cmd", "pose2d", "emergency_stop", "stdout"],
        "init": {}
      },
      "slip": {
        "driver": "osgar.drivers.deedee:Slip",
        "in": ["packet", "raw"],
        "out": ["packet", "raw"],
        "init": {}
      },
      "serial": {
        "driver": "serial",
        "in": ["raw"],
        "out": ["raw"],
        "init": {"port": "/dev/ttyUSB0",
                 "speed": 115200,
                 "reset": 1}
      },
      "realsense": {
        "driver": "realsense_multicam",
        "init": {
          "devices": [{"type": "D400", "serial_number": "038122250496", "name": "front"},
                      {"type": "D400", "serial_number": "035622251357", "name": "rear"},
                      {"type": "T200", "serial_number": "952322110907", "name": "tracking", "pitch": -90, "yaw": 180}
          ],
          "depth_subsample": 1,
          "depth_rgb": true,
          "depth_resolution": [
            640,
            480
          ],
          "rgb_resolution": [
            640,
            480
          ],
          "depth_fps": 5,
          "pose_subsample": 25
        }
      },
      "small_front": {
        "driver": "resize",
        "in": ["depth"],
        "out": ["depth"],
        "init": {
          "width": 80,
          "height": 60
        }
      },
      "small_rear": {
        "driver": "resize",
        "in": ["depth"],
        "out": ["depth"],
        "init": {
          "width": 80,
          "height": 60
        }
      },
      "ros": {
        "driver": "subt.roslaunch:ROSLaunch",
        "in": [],
        "out": [],
        "init": {
          "launch_file": "subt/ros/robot/launch/deedee.launch"
        }
      },
      "fromros": {
          "driver": "subt.pull:Pull",
          "out": "scan360",
          "init": {
              "outputs": ["scan360"]
          }
      },
      "toros": {
          "driver": "subt.push:Push"
      }
    },
    "links": [["timer.tick", "deedee.tick"],
              ["deedee.cmd", "slip.packet"],
              ["slip.packet", "deedee.info"],
              ["slip.raw", "serial.raw"],
              ["serial.raw", "slip.raw"],
              ["realsense.front_depth", "small_front.depth"],
              ["realsense.rear_depth", "small_rear.depth"],
              ["small_front.depth", "toros.front_depth"],
              ["small_rear.depth", "toros.rear_depth"],
              ["realsense.tracking_pose3d", "toros.tracking_pose"],
              ["fromros.scan360", "app.scan360"],
              ["realsense.tracking_pose3d", "app.pose3d"],
              ["app.desired_speed", "deedee.desired_speed"]]
  }
}
